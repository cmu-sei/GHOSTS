@model List<Ghosts.Socializer.Infrastructure.Post>
@{
    Layout = null;
    var profileUsername = (ViewContext.RouteData.Values["username"] as string)?.Trim();
    if (string.IsNullOrWhiteSpace(profileUsername))
    {
        profileUsername = Context.Request.Cookies["username"];
    }

    if (string.IsNullOrWhiteSpace(profileUsername))
    {
        profileUsername = Model?.FirstOrDefault()?.Username ?? "user";
    }
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>(@profileUsername) ‚Ä¢ Instagram</title>
    <link rel="stylesheet" href="css/profile.css">
    <link rel="icon" href="images/instagram-icon.png">
    <style>
        .follow-action-form {
            margin-left: 12px;
        }

        .follow-action-button {
            background: #0095f6;
            border: none;
            color: #fff;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
        }

        .connections-columns {
            display: grid;
            gap: 16px;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            margin-top: 16px;
        }

        .connections-column {
            background: #fafafa;
            border: 1px solid #dbdbdb;
            border-radius: 12px;
            padding: 16px;
        }

        .connections-column h3 {
            margin: 0 0 12px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }

        .connections-scroll {
            max-height: 220px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-container">
                <div class="logo">
                    <img src="images/instagram-logo.png" alt="Instagram" class="instagram-logo">
                </div>
                <div class="search-container">
                    <div class="search-box">
                        <span class="search-icon">üîç</span>
                        <input type="text" placeholder="Search" class="search-input">
                    </div>
                </div>
                <div class="header-actions">
                    <button class="action-btn">üè†</button>
                    <button class="action-btn">üí¨</button>
                    <button class="action-btn">‚ûï</button>
                    <button class="action-btn">üß≠</button>
                    <button class="action-btn">‚ù§Ô∏è</button>
                    <div class="profile-menu">
                        <img src="/u/@profileUsername/avatar" alt="@profileUsername" class="header-avatar">
                    </div>
                </div>
            </div>
        </header>

        <!-- Profile Content -->
        <div class="profile-container">
            <!-- Profile Header -->
            <div class="profile-header">
                <div class="profile-image">
                    <img src="/u/@profileUsername/avatar" alt="@profileUsername" class="profile-avatar">
                </div>
                <div class="profile-info">
                    <div class="profile-top">
                        <h1 class="username">@profileUsername</h1>
                        <div class="profile-actions">
                            <button class="edit-profile-btn">Edit profile</button>
                            <button class="view-archive-btn">View archive</button>
                            <button class="settings-btn">‚öôÔ∏è</button>
                            @await Html.PartialAsync("~/Views/Shared/_FollowActions.cshtml")
                        </div>
                    </div>
                    <div class="profile-stats" data-profile-connections data-username="@profileUsername">
                        <div class="stat">
                            <span class="stat-number">@(Model?.Count ?? 0)</span>
                            <span class="stat-label">posts</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" data-followers-count>0</span>
                            <span class="stat-label">followers</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" data-following-count>0</span>
                            <span class="stat-label">following</span>
                        </div>
                    </div>
                    <div class="connections-columns">
                        <div class="connections-column">
                            <h3>Following (<span data-following-count>0</span>)</h3>
                            <div class="connections-scroll" data-following-list></div>
                        </div>
                        <div class="connections-column">
                            <h3>Followers (<span data-followers-count>0</span>)</h3>
                            <div class="connections-scroll" data-followers-list></div>
                        </div>
                    </div>
                    <div class="profile-bio">
                        <div class="display-name">John Doe</div>
                        <div class="bio-text">
                            Software Developer üíª | Photography enthusiast üì∏
                            <br>Building amazing things with code
                            <br>üìç San Francisco, CA
                            <br>üîó <a href="#">johndoe.dev</a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Highlights -->
            <div class="highlights-section">
                <div class="highlight-item">
                    <div class="highlight-avatar">
                        <img src="images/highlight1.jpg" alt="Highlight" class="highlight-image">
                    </div>
                    <span class="highlight-title">Travel</span>
                </div>
                <div class="highlight-item">
                    <div class="highlight-avatar">
                        <img src="images/highlight2.jpg" alt="Highlight" class="highlight-image">
                    </div>
                    <span class="highlight-title">Food</span>
                </div>
                <div class="highlight-item">
                    <div class="highlight-avatar">
                        <img src="images/highlight3.jpg" alt="Highlight" class="highlight-image">
                    </div>
                    <span class="highlight-title">Work</span>
                </div>
                <div class="highlight-item">
                    <div class="highlight-avatar">
                        <img src="images/highlight4.jpg" alt="Highlight" class="highlight-image">
                    </div>
                    <span class="highlight-title">Nature</span>
                </div>
            </div>

            <!-- Profile Tabs -->
            <div class="profile-tabs">
                <button class="tab-btn active">
                    <span class="tab-icon">‚äû</span>
                    <span class="tab-text">POSTS</span>
                </button>
                <button class="tab-btn">
                    <span class="tab-icon">‚ßá</span>
                    <span class="tab-text">REELS</span>
                </button>
                <button class="tab-btn">
                    <span class="tab-icon">‚öè</span>
                    <span class="tab-text">SAVED</span>
                </button>
                <button class="tab-btn">
                    <span class="tab-icon">üè∑Ô∏è</span>
                    <span class="tab-text">TAGGED</span>
                </button>
            </div>

            <!-- Posts Grid -->
            <div class="posts-grid">
                <div class="post-item">
                    <img src="images/grid-post1.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 234</span>
                            <span class="stat">üí¨ 12</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post2.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 189</span>
                            <span class="stat">üí¨ 8</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post3.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 456</span>
                            <span class="stat">üí¨ 23</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post4.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 312</span>
                            <span class="stat">üí¨ 15</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post5.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 567</span>
                            <span class="stat">üí¨ 34</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post6.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 123</span>
                            <span class="stat">üí¨ 7</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post7.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 891</span>
                            <span class="stat">üí¨ 45</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post8.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 267</span>
                            <span class="stat">üí¨ 18</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post9.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 445</span>
                            <span class="stat">üí¨ 29</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post10.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 678</span>
                            <span class="stat">üí¨ 52</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post11.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 234</span>
                            <span class="stat">üí¨ 14</span>
                        </div>
                    </div>
                </div>
                <div class="post-item">
                    <img src="images/grid-post12.jpg" alt="Post" class="grid-image">
                    <div class="post-overlay">
                        <div class="post-stats">
                            <span class="stat">‚ù§Ô∏è 356</span>
                            <span class="stat">üí¨ 21</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/profile.js"></script>
    <script src="/js/connections.js"></script>
</body>
</html>
