@model Ghosts.Socializer.Infrastructure.Post
@{
    Layout = null;
    ViewBag.Theme = "x";
    if (ViewBag.ProfileUsername == null && Model != null)
    {
        ViewBag.ProfileUsername = Model.Username;
    }

    var currentUser = ViewBag.Username as string;
    var currentUserLiked = Model != null && !string.IsNullOrWhiteSpace(currentUser) &&
        (Model.Likes?.Any(l => string.Equals(l.Username, currentUser, StringComparison.OrdinalIgnoreCase)) ?? false);
    var likedClass = currentUserLiked ? " liked" : string.Empty;
    var likesCount = Model?.Likes?.Count ?? 0;
    var commentsCount = Model?.Comments?.Count ?? 0;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@(Model != null ? $"{Model.Username} on X" : "Post") / X</title>
    <link rel="stylesheet" href="css/post.css">
    <link rel="icon" href="images/x-icon.png">
</head>
<body>
    <div class="app">
        <!-- Left Sidebar -->
        <div class="sidebar">
            <div class="sidebar-content">
                <div class="logo">
                    <img src="images/x-logo.png" alt="X" class="x-logo">
                </div>
                <nav class="nav-menu">
                    <a href="feed.html" class="nav-item">
                        <span class="nav-icon">üè†</span>
                        <span class="nav-text">Home</span>
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon">üîç</span>
                        <span class="nav-text">Explore</span>
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon">üîî</span>
                        <span class="nav-text">Notifications</span>
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon">‚úâÔ∏è</span>
                        <span class="nav-text">Messages</span>
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon">üîñ</span>
                        <span class="nav-text">Bookmarks</span>
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon">üë•</span>
                        <span class="nav-text">Communities</span>
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon">‚ùå</span>
                        <span class="nav-text">Premium</span>
                    </a>
                    <a href="profile.html" class="nav-item">
                        <span class="nav-icon">üë§</span>
                        <span class="nav-text">Profile</span>
                    </a>
                    <a href="#" class="nav-item">
                        <span class="nav-icon">‚ãØ</span>
                        <span class="nav-text">More</span>
                    </a>
                </nav>
                <button class="post-button">Post</button>
            </div>
            <div class="user-info">
                <img src="/u/@(Model?.Username ?? "user")/avatar" alt="@(Model?.Username ?? "User")" class="user-avatar">
                <div class="user-details">
                    <div class="username">@(Model?.Username ?? "User")</div>
                    <div class="handle">@($"@{Model?.Username ?? "user"}")</div>
                </div>
                <span class="more-options">‚ãØ</span>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="post-header">
                <div class="header-nav">
                    <button class="back-btn">‚Üê</button>
                    <h1>Post</h1>
                </div>
            </div>

            <!-- Main Post -->
            <div class="main-post">
                <div class="post-author">
                    <img src="/u/@(Model?.Username ?? "user")/avatar" alt="@(Model?.Username ?? "User")" class="author-avatar">
                    <div class="author-info">
                        <div class="author-name">@(Model?.Username ?? "User")</div>
                        <div class="author-handle">@($"@{Model?.Username ?? "user"}")</div>
                    </div>
                    <button class="follow-btn">Follow</button>
                    <button class="post-more">‚ãØ</button>
                </div>

                <div class="post-content">
                    <div class="post-text">
                        @Html.Raw(Model?.Message ?? "Post unavailable.")
                    </div>

                    <div class="post-timestamp">
                        @if (Model != null)
                        {
                            <span class="post-time">@Model.CreatedUtc.ToString("h:mm tt")</span>
                            <span class="post-separator">¬∑</span>
                            <span class="post-date">@Model.CreatedUtc.ToString("MMM d, yyyy")</span>
                        }
                    </div>

                    <div class="post-stats">
                        <div class="stat-item">
                            <span class="stat-number">@commentsCount</span>
                            <span class="stat-label">Comments</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">@likesCount</span>
                            <span class="stat-label">Likes</span>
                        </div>
                    </div>

                    <div class="post-actions">
                        <button class="action-btn reply">
                            <span class="action-icon">üí¨</span>
                        </button>
                        <button class="action-btn repost">
                            <span class="action-icon">üîÑ</span>
                        </button>
                        <button class="action-btn like-it@(likedClass)" data-id="@((Model?.Id ?? Guid.Empty).ToString())">
                            <span class="action-icon">@(currentUserLiked ? "‚ù§Ô∏è" : "ü§ç")</span>
                            <span class="action-count">@likesCount</span>
                        </button>
                        <button class="action-btn bookmark">
                            <span class="action-icon">üîñ</span>
                        </button>
                        <button class="action-btn share">
                            <span class="action-icon">üì§</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Reply Section -->
            <div class="reply-section">
                <div class="reply-compose">
                    <img src="images/profile-avatar.jpg" alt="Profile" class="reply-avatar">
                    <div class="reply-content">
                        <textarea placeholder="Post your reply" class="reply-textarea"></textarea>
                        <div class="reply-actions">
                            <div class="reply-options">
                                <button class="reply-option">üì∑</button>
                                <button class="reply-option">üé•</button>
                                <button class="reply-option">üìä</button>
                                <button class="reply-option">üòä</button>
                            </div>
                            <button class="reply-btn" disabled>Reply</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Replies -->
            <div class="replies">
                <div class="reply">
                    <img src="images/user2-avatar.jpg" alt="Tech News" class="reply-avatar">
                    <div class="reply-content">
                        <div class="reply-header">
                            <span class="reply-name">Tech News</span>
                            <span class="reply-handle">#technews</span>
                            <span class="reply-verified">‚úì</span>
                            <span class="reply-time">¬∑ 1h</span>
                            <span class="reply-more">‚ãØ</span>
                        </div>
                        <div class="reply-text">
                            Congratulations! Can't wait to try it out. What's the biggest improvement?
                        </div>
                        <div class="reply-actions">
                            <button class="action-btn">
                                <span class="action-icon">üí¨</span>
                                <span class="action-count">3</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üîÑ</span>
                                <span class="action-count">8</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">‚ù§Ô∏è</span>
                                <span class="action-count">24</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üì§</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="reply">
                    <img src="images/user3-avatar.jpg" alt="Design Inspiration" class="reply-avatar">
                    <div class="reply-content">
                        <div class="reply-header">
                            <span class="reply-name">Design Inspiration</span>
                            <span class="reply-handle">#designinspo</span>
                            <span class="reply-time">¬∑ 45m</span>
                            <span class="reply-more">‚ãØ</span>
                        </div>
                        <div class="reply-text">
                            Amazing work! The attention to detail really shows. Your team should be proud üëè
                        </div>
                        <div class="reply-actions">
                            <button class="action-btn">
                                <span class="action-icon">üí¨</span>
                                <span class="action-count">1</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üîÑ</span>
                                <span class="action-count">5</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">‚ù§Ô∏è</span>
                                <span class="action-count">18</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üì§</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="reply">
                    <img src="images/suggested1.jpg" alt="Jane Smith" class="reply-avatar">
                    <div class="reply-content">
                        <div class="reply-header">
                            <span class="reply-name">Jane Smith</span>
                            <span class="reply-handle">#janesmith</span>
                            <span class="reply-time">¬∑ 30m</span>
                            <span class="reply-more">‚ãØ</span>
                        </div>
                        <div class="reply-text">
                            This is exactly what we needed! How long did the development process take?
                        </div>
                        <div class="reply-actions">
                            <button class="action-btn">
                                <span class="action-icon">üí¨</span>
                                <span class="action-count">2</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üîÑ</span>
                                <span class="action-count">3</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">‚ù§Ô∏è</span>
                                <span class="action-count">12</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üì§</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Nested Reply -->
                <div class="reply nested">
                    <div class="reply-thread"></div>
                    <img src="images/user1-avatar.jpg" alt="Alice Johnson" class="reply-avatar">
                    <div class="reply-content">
                        <div class="reply-header">
                            <span class="reply-name">Alice Johnson</span>
                            <span class="reply-handle">#alicej</span>
                            <span class="reply-time">¬∑ 15m</span>
                            <span class="reply-more">‚ãØ</span>
                        </div>
                        <div class="reply-text">
                            <span class="reply-to">Replying to #janesmith</span>
                            About 3 months from concept to deployment! The hardest part was getting the UX just right.
                        </div>
                        <div class="reply-actions">
                            <button class="action-btn">
                                <span class="action-icon">üí¨</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üîÑ</span>
                                <span class="action-count">1</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">‚ù§Ô∏è</span>
                                <span class="action-count">7</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üì§</span>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="reply">
                    <img src="images/suggested2.jpg" alt="Tech Guru" class="reply-avatar">
                    <div class="reply-content">
                        <div class="reply-header">
                            <span class="reply-name">Tech Guru</span>
                            <span class="reply-handle">#techguru</span>
                            <span class="reply-time">¬∑ 10m</span>
                            <span class="reply-more">‚ãØ</span>
                        </div>
                        <div class="reply-text">
                            Looks promising! Will this be available for all users or rolling out gradually?
                        </div>
                        <div class="reply-actions">
                            <button class="action-btn">
                                <span class="action-icon">üí¨</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üîÑ</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">‚ù§Ô∏è</span>
                                <span class="action-count">4</span>
                            </button>
                            <button class="action-btn">
                                <span class="action-icon">üì§</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar -->
        <div class="right-sidebar">
            <div class="search-bar">
                <input type="text" placeholder="Search">
                <span class="search-icon">üîç</span>
            </div>

            <div class="trending-section">
                <h2>What's happening</h2>
                <div class="trending-item">
                    <div class="trending-category">Technology ¬∑ Trending</div>
                    <div class="trending-topic">Product Launch</div>
                    <div class="trending-posts">12.5k posts</div>
                </div>
                <div class="trending-item">
                    <div class="trending-category">Programming ¬∑ Trending</div>
                    <div class="trending-topic">New Features</div>
                    <div class="trending-posts">8.2k posts</div>
                </div>
                <div class="trending-item">
                    <div class="trending-category">Tech News ¬∑ Trending</div>
                    <div class="trending-topic">Software Update</div>
                    <div class="trending-posts">15.7k posts</div>
                </div>
            </div>

            <div class="suggestions-section">
                <h2>Who to follow</h2>
                <div class="suggestion-item">
                    <img src="images/suggested1.jpg" alt="User" class="suggestion-avatar">
                    <div class="suggestion-info">
                        <div class="suggestion-name">Jane Smith</div>
                        <div class="suggestion-handle">#janesmith</div>
                    </div>
                    <button class="follow-btn">Follow</button>
                </div>
                <div class="suggestion-item">
                    <img src="images/suggested2.jpg" alt="User" class="suggestion-avatar">
                    <div class="suggestion-info">
                        <div class="suggestion-name">Tech Guru</div>
                        <div class="suggestion-handle">#techguru</div>
                    </div>
                    <button class="follow-btn">Follow</button>
                </div>
            </div>
        </div>
    </div>

    <script src="/js/jQuery/jquery-3.5.1.min.js"></script>
    <script src="/js/signalr.min.js"></script>
    <script src="/js/social.js"></script>
    <script src="js/post.js"></script>
</body>
</html>
