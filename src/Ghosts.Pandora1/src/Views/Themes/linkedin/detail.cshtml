@model Ghosts.Pandora.Infrastructure.Models.Post
@{
    Layout = null;
    ViewBag.Theme = "linkedin";
    var currentUser = ViewBag.Username as string;
    var currentUserLiked = !string.IsNullOrWhiteSpace(currentUser) &&
        (Model?.Likes?.Any(l => string.Equals(l.Username, currentUser, StringComparison.OrdinalIgnoreCase)) ?? false);
    var likedClass = currentUserLiked ? " liked" : string.Empty;
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="current-user" content="@ViewBag.Username">
    <title>@Model.User's Post | LinkedIn</title>
    <link rel="stylesheet" href="/themes/linkedin/css/feed.css?@System.Guid.NewGuid()">
    <link rel="icon" href="/themes/linkedin/images/linkedin-icon.png">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <div class="header-container">
                <div class="header-left">
                    <a href="/"><img src="/themes/linkedin/images/linkedin-logo.png" alt="LinkedIn" class="linkedin-logo"></a>
                    <div class="search-container">
                        <input type="text" placeholder="Search" class="search-input">
                        <button class="search-btn">üîç</button>
                    </div>
                </div>
                <nav class="header-nav">
                    <a href="/" class="nav-item active" style="text-decoration: none; color: inherit; display: flex; flex-direction: column; align-items: center;">
                        <span class="nav-icon">üè†</span>
                        <span class="nav-text">Home</span>
                    </a>
                    <div class="nav-item">
                        <span class="nav-icon">üë•</span>
                        <span class="nav-text">My Network</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">üíº</span>
                        <span class="nav-text">Jobs</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">üí¨</span>
                        <span class="nav-text">Messaging</span>
                    </div>
                    <div class="nav-item">
                        <span class="nav-icon">üîî</span>
                        <span class="nav-text">Notifications</span>
                    </div>
                    <div class="nav-item">
                        <img src="/u/@ViewBag.Username/avatar" alt="Me" class="nav-avatar">
                        <span class="nav-text">Me</span>
                        <span class="dropdown-arrow">‚ñº</span>
                    </div>
                </nav>
            </div>
        </header>

        <!-- Main Container -->
        <div class="main-container">
            <!-- Left Sidebar -->
            <aside class="left-sidebar">
                <!-- Profile Card -->
                <div class="profile-card">
                    <div class="profile-cover"></div>
                    <div class="profile-info">
                        <img src="/u/@ViewBag.Username/avatar" alt="Profile" class="profile-avatar">
                        <div class="profile-details">
                            <h3 class="profile-name">@ViewBag.Username</h3>
                            <p class="profile-headline">Professional</p>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Post Detail -->
                <div class="post-detail">
                    <article class="post" data-post-id="@Model.Id">
                        <!-- Post Header -->
                        <div class="post-header">
                            <div class="post-author">
                                <img src="/u/@Model.Username/avatar" alt="@Model.Username" class="author-avatar">
                                <div class="author-info">
                                    <div class="author-name">@Model.Username</div>
                                    <div class="author-title">Professional</div>
                                    <div class="post-time">@Model.CreatedUtc.ToString("MMM d, yyyy") ‚Ä¢ üåç</div>
                                </div>
                            </div>
                            <button class="post-menu">‚ãØ</button>
                        </div>

                        <!-- Post Content -->
                        <div class="post-content">
                            <div class="post-text">
                                @Html.Raw(Model.Message)
                            </div>
                        </div>

                        <!-- Post Stats -->
                        <div class="post-stats">
                            <div class="engagement-stats">
                                @{
                                    var likesCount = Model.Likes?.Count ?? 0;
                                    var commentsCount = Model.Comments?.Count ?? 0;
                                }
                                @if (likesCount > 0)
                                {
                                    <span class="stat-item">üëç @likesCount</span>
                                }
                                @if (commentsCount > 0)
                                {
                                    <span class="stat-item">@commentsCount comments</span>
                                }
                            </div>
                        </div>

                        <!-- Post Actions -->
                        <div class="post-actions">
                            <button class="action-btn like-btn like-it@likedClass" data-id="@Model.Id">
                                <span class="action-icon">üëç</span>
                                <span class="action-text">@(currentUserLiked ? $"Liked ({Model.Likes?.Count ?? 0})" : "Like")</span>
                            </button>
                            <button class="action-btn comment-btn">
                                <span class="action-icon">üí¨</span>
                                <span class="action-text">Comment</span>
                            </button>
                            <button class="action-btn share-btn">
                                <span class="action-icon">üì§</span>
                                <span class="action-text">Share</span>
                            </button>
                            <button class="action-btn send-btn">
                                <span class="action-icon">üìß</span>
                                <span class="action-text">Send</span>
                            </button>
                        </div>
                    </article>

                    <!-- Comments Section -->
                    <div class="comments-section">
                        <!-- Add Comment -->
                        <div class="add-comment">
                            <img src="/u/@ViewBag.Username/avatar" alt="Your avatar" class="comment-avatar">
                            <div class="comment-input-container">
                                <input type="text" placeholder="Add a comment..." class="comment-input">
                                <button class="comment-post-btn">Post</button>
                            </div>
                        </div>

                        <!-- Comments List -->
                        <div class="comments-list">
                            @if (Model.Comments != null)
                            {
                                @foreach (var comment in Model.Comments)
                                {
                                    <div class="comment">
                                        <img src="/u/@comment.Username/avatar" alt="@comment.Username" class="comment-avatar">
                                        <div class="comment-content">
                                            <div class="comment-header">
                                                <span class="comment-author">@comment.Username</span>
                                                <span class="comment-title">Professional</span>
                                                <span class="comment-time">@comment.CreatedUtc.ToString("MMM d")</span>
                                            </div>
                                            <div class="comment-text">
                                                @comment.Message
                                            </div>
                                            <div class="comment-actions">
                                                <button class="comment-action like-action">Like</button>
                                                <button class="comment-action reply-action">Reply</button>
                                            </div>
                                        </div>
                                        <button class="comment-menu">‚ãØ</button>
                                    </div>
                                }
                            }
                            else
                            {
                                <div class="no-comments">
                                    <p>No comments yet. Start the conversation!</p>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            </main>

            <!-- Right Sidebar -->
            <aside class="right-sidebar">
                <div class="sidebar-widget">
                    <h3 class="widget-title">LinkedIn News</h3>
                    <div class="news-item">
                        <div class="news-title">‚Ä¢ Industry insights</div>
                        <div class="news-meta">2h ago ‚Ä¢ 1,234 readers</div>
                    </div>
                    <div class="news-item">
                        <div class="news-title">‚Ä¢ Professional networking tips</div>
                        <div class="news-meta">4h ago ‚Ä¢ 892 readers</div>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    @await Html.PartialAsync("_Scripts")
</body>
</html>
