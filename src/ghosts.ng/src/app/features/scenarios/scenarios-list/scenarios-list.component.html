<div class="page-header">
  <h1>Scenarios</h1>
  <button mat-raised-button color="primary" (click)="createNewScenario()">
    <i class="fas fa-plus"></i>
    Create New Scenario
  </button>
</div>

<div class="search-container">
  <app-search-bar (searchChange)="onSearchChange($event)"></app-search-bar>
  @if (searchTerm()) {
    <div class="search-results-info">
      Showing {{ filteredScenarios().length }} of {{ scenarios().length }} scenarios
    </div>
  }
</div>

<!-- Loading State -->
@if (loading()) {
<div class="loading">
  <mat-spinner diameter="40"></mat-spinner>
  <p>Loading scenarios...</p>
</div>
}

<!-- Error State -->
@if (error() && !loading()) {
<div class="error">
  <i class="fas fa-exclamation-circle"></i>
  <p>{{ error() }}</p>
  <button mat-raised-button color="primary" (click)="loadScenarios()">
    <i class="fas fa-sync"></i>
    Retry
  </button>
</div>
}

<!-- Empty State -->
@if (!loading() && !error() && scenarios().length === 0) {
<div class="empty-state">
  <i class="fas fa-folder-open"></i>
  <h2>No scenarios yet</h2>
  <p>Create your first cyber exercise scenario to get started</p>
  <button mat-raised-button color="primary" (click)="createNewScenario()">
    <i class="fas fa-plus"></i>
    Create New Scenario
  </button>
</div>
}

<!-- Scenarios Grid -->
@if (!loading() && !error() && scenarios().length > 0) {
<div class="scenarios-grid">
  @for (scenario of filteredScenarios(); track scenario.id) {
  <mat-card class="scenario-card" (click)="editScenario(scenario.id)">
    <mat-card-header>
      <mat-card-title>{{ scenario.name }}</mat-card-title>
      <mat-card-subtitle>
        <span>Updated: {{ formatDate(scenario.updatedAt) }}</span>
      </mat-card-subtitle>
    </mat-card-header>
    <mat-card-content>
      <p class="description">{{ scenario.description || 'No description provided' }}</p>

      <div class="stats-grid">
        @if (scenario.scenarioParameters) {
        <div class="stat-item">
          <i class="fas fa-globe"></i>
          <span>{{ scenario.scenarioParameters.nations.length }} Nations</span>
        </div>
        <div class="stat-item">
          <i class="fas fa-user-secret"></i>
          <span>{{ scenario.scenarioParameters.threatActors.length }} Threat Actors</span>
        </div>
        }
        @if (scenario.timeline) {
        <div class="stat-item">
          <i class="fas fa-calendar-alt"></i>
          <span>{{ scenario.timeline.events.length }} Events</span>
        </div>
        }
        @if (scenario.simulationMechanics) {
        <div class="stat-item">
          <i class="fas fa-clock"></i>
          <span>{{ scenario.simulationMechanics.durationHours }}h Duration</span>
        </div>
        }
      </div>
    </mat-card-content>
    <mat-card-actions>
      <button mat-button color="primary" (click)="editScenario(scenario.id); $event.stopPropagation()">
        <i class="fas fa-edit"></i>
        Edit
      </button>
      <button
        mat-button
        color="accent"
        (click)="executeScenario(scenario, $event)">
        <i class="fas fa-play"></i>
        Execute
      </button>
      <button mat-button color="warn" (click)="deleteScenario(scenario, $event)">
        <i class="fas fa-trash"></i>
        Delete
      </button>
    </mat-card-actions>
  </mat-card>
  }
</div>
}
